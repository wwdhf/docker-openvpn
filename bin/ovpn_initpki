# Initialize the EasyRSA PKI
source "$OPENVPN/ovpn_env.sh"

# Initialize PKI directory and build CA certificate
easyrsa init-pki
easyrsa --keysize=4096 build-ca

# Generate Diffie-Hellman parameters
easyrsa gen-dh

# Generate a HMAC signature to strengthen the server's TLS integrity verification capabilities
openvpn --genkey --secret $EASYRSA_PKI/ta.key

# Build the server certificate, key, and encryption files
easyrsa build-server-full "$OVPN_CN"
